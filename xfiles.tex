% !TEX program = xelatex

\documentclass[10pt,a4paper]{article}
\usepackage[top = 1.5cm, bottom = 1.5cm, left = 1.5cm, right = 1.5cm]{geometry}

\usepackage{titling}
\usepackage[czech]{babel}
\usepackage{graphicx}
\usepackage{lmodern}
\usepackage{hyperref}
\usepackage{setspace}
\usepackage{csvsimple}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{gensymb}
\usepackage{units}
\usepackage{bm}
\delimitershortfall=-1pt

\usepackage{gnuplottex}
\usepackage{epstopdf}

\usepackage{xltxtra}
\usepackage{xelatexemoji}

% no page break
\newenvironment{absolutelynopagebreak}
  {\par\nobreak\vfil\penalty0\vfilneg
   \vtop\bgroup}
  {\par\xdef\tpd{\the\prevdepth}\egroup
   \prevdepth=\tpd}


% redefine \sqrt
\usepackage{letltxmacro}
\makeatletter
\let\oldr@@t\r@@t
\def\r@@t#1#2{%
\setbox0=\hbox{$\oldr@@t#1{#2\,}$}\dimen0=\ht0
\advance\dimen0-0.2\ht0
\setbox2=\hbox{\vrule height\ht0 depth -\dimen0}%
{\box0\lower0.4pt\box2}}
\LetLtxMacro{\oldsqrt}{\sqrt}
\renewcommand*{\sqrt}[2][\ ]{\oldsqrt[#1]{#2\,}\,}
\makeatother

\def\ph{\phantom}
\def\vph{\vphantom}
\def\hph{\hphantom}

\newcommand{\comm}[2]{\left[ #1, #2 \right]}
\newcommand{\const}[1]{\text{\rmfamily\upshape #1}}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}

\newcommand{\mat}[1]{
    \begin{pmatrix}
        #1
    \end{pmatrix}
}

\newcommand{\mata}[2]{
    \left(
    \begin{array}{@{}#1@{}}
        #2
    \end{array}
    \right)
}

\renewcommand{\d}[1]{\;\const{d}#1}
\newcommand{\dd}[2]{\frac{\const{d} #1}{\const{d} #2} \;}
\newcommand{\pd}[2]{\frac{\partial  #1}{\partial  #2} \;}

\newcommand{\bra}[1]{\left< #1 \right|}
\newcommand{\ket}[1]{\left| #1 \right>}
\newcommand{\braket}[2]{\left< #1 \middle| #2 \right>}

\newcommand{\e}[1]{\const{e}^{#1}}
\renewcommand{\i}{\const{i}}

\begin{document}

\title{Matematika pro fyziky 1: The X-Files üëΩÔ∏è}
\author{Michal Gr≈ào}
\date{\today}

\maketitle

\section{‚ùìÔ∏è‚ùìÔ∏è‚ùìÔ∏è}

\begin{gather*}
    \bm{p}, \bm{q} \in \mathbb{R}^2
    \;\;\;\;\;
    H = \norm{\bm{p}}^2 + \norm{\bm{q}}^2
    \\[10pt]
    \dot{q}_j = \pd{H}{p_j}
    \;\;\;\;\;
    \dot{p}_j = -\pd{H}{q_j} - \zeta \left( \pd{H}{p_1} - \pd{H}{p_2} \right)
\end{gather*}

\section{‚ùóÔ∏è‚ùóÔ∏è‚ùóÔ∏è}

\subsection{
    \texorpdfstring{
        $\pmb{ p,q = \mathit{?} }$
    }{
        p,q = ?
    }
}

\begin{align*}
    \bm{v} &= \mat{ \bm{q} \\ \bm{p} } = \mat{ q_1 \\ q_2 \\ p_1 \\ p_2}
    &
    \dot{\bm{v}} &= \mat{
        -\pd{H}{q_1} - \zeta \left( \pd{H}{p_1} - \pd{H}{p_2} \right) \\
        -\pd{H}{q_2} - \zeta \left( \pd{H}{p_1} - \pd{H}{p_2} \right) \\
        \pd{H}{p_1} \\ \pd{H}{p_2}
    }
    =
    \underbrace{
        2
        \mat{
            0 & 0 & 1 & 0 \\
            0 & 0 & 0 & 1 \\
            1 & 0 & - \zeta & \zeta \\
            0 & 1 & - \zeta & \zeta
        }
    }_M \bm{v}
\end{align*}

\begin{align*}
    \boxed{
        \dot{\bm{v}} = M \bm{v} \;\;\;
        \implies \;\;\;
        \bm{v} = \exp(t M) \bm{v_0}, \;\;\;
        \bm{v_0} \in \mathbb{R}^2
    }
\end{align*}


\subsection{
    \texorpdfstring{
        $\pmb{ \exp(tM) = \mathit{?} }$
    }{
        exp(tM) = ?
    }
}
\begin{align*}
    \underbrace{
        2t
        \mat{
            0 & 0 & 1 & 0 \\
            0 & 0 & 0 & 1 \\
            1 & 0 & - \zeta & \zeta \\
            0 & 1 & - \zeta & \zeta
        }
    }_{
        tM
    }
    =
    \underbrace{
        \mat{t z & \frac{z}{2} - 1 & - t z & \frac{z}{2} + 1\\t z & \frac{z}{2} & - t z & \frac{z}{2}\\- t z & 1 & - t z & 1\\- t z & 0 & - t z & 0}
    }_{
        P^{-1}
    }
    \underbrace{
        \mat{- 2 t & 1 & 0 & 0\\0 & - 2 t & 0 & 0\\0 & 0 & 2 t & 1\\0 & 0 & 0 & 2 t}
    }_{
        J
    }
    \underbrace{
        \mat{0 & \frac{1}{2 t z} & - \frac{1}{4 t} & \frac{z - 2}{4 t z}\\- \frac{1}{2} & \frac{1}{2} & \frac{1}{2} & - \frac{1}{2}\\0 & - \frac{1}{2 t z} & \frac{1}{4 t} & - \frac{z + 2}{4 t z}\\\frac{1}{2} & - \frac{1}{2} & \frac{1}{2} & - \frac{1}{2}}
    }_{
        P
    }
\end{align*}


\end{document}
